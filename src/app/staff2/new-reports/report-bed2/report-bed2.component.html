<nav style="margin-bottom: 16px;" class="breadcrumb">
  <span class="breadcrumb-item active"> รายงานเตียง (new) </span>
</nav>

<div style="display: flex; justify-content: space-between;">
  <div> </div>
  <div>
    <button class="btn btn-primary btn-sm" (click)="exportExcel()">
      export excel
    </button>
  </div>
</div>

<div style="overflow-x: auto; margin-bottom: 24px;">
  <table style="border-collapse: collapse;" class="table table-compact">
    <thead>
      <tr>
        <th rowspan="2" class="td-border"> โรงพยาบาล </th>
        <th colspan="3" class="td-border" *ngFor="let h of header">{{h.name}}</th>
        <th rowspan="2"> สังกัด </th>
      </tr>
      <tr>
        <th class="td-border" *ngFor="let s of subHeader"> {{s}} </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let items of data; let i = index">
        <td>{{items.hospname}}</td> 
        <td *ngFor="let item of items.array">{{cal.checkValue(item)}}</td>
        <td>{{items.sub_ministry_name}}</td> 
        <!-- <td>
          <div style="width: 200px;">
            {{ item.sub_ministry_name || '-' }}
          </div>
        </td> -->
      </tr>
    </tbody>
  </table>
</div>

<div *ngIf="isLoading && !data.length" style="display: flex; justify-content: center;">
  กำลังโหลดข้อมูล ...
</div>

<div *ngIf="!isLoading && !data.length" style="display: flex; justify-content: center;">
  ไม่พบข้อมูล
</div>

<app-loadding #loading></app-loadding>
